<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Pulkstenis-Robinson Test for Categorical Response Models — pulkroben • gofcat</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Pulkstenis-Robinson Test for Categorical Response Models — pulkroben"><meta property="og:description" content="This provides a post estimation goodness-of-fit test for
the ordinal response models. Supported models include the proportional odds,
adjacent-category, and constrained continuation-ratio models."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gofcat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pulkstenis-Robinson Test for Categorical Response Models</h1>
    
    <div class="hidden name"><code>pulkroben.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This provides a post estimation goodness-of-fit test for
the ordinal response models. Supported models include the proportional odds,
adjacent-category, and constrained continuation-ratio models.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pulkroben</span><span class="op">(</span><span class="va">model</span>, test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chisq"</span>, <span class="st">"deviance"</span><span class="op">)</span>, tables <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>model</dt>
<dd><p>a model object or data.frame of observed and estimated
values. The following class of objects can be directly passed to the
<code>pulkroben</code> function: vglm(), serp(), polr(), and clm(). Other class of
objects require providing a data.frame of observed and predicted values.</p></dd>


<dt>test</dt>
<dd><p>chooses between the chi-squared and the deviance test statistic.</p></dd>


<dt>tables</dt>
<dd><p>Default to FALSE. When TRUE, both the observed and the
expected frequency tables are printed alongside test results.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>stat</dt>
<dd><p>realized value of the chi-square or deviance statistic.</p></dd>


<dt>df</dt>
<dd><p>the degrees of freedom.</p></dd>


<dt>p.value</dt>
<dd><p>the p-value of the test statistic.</p></dd>


<dt>observed</dt>
<dd><p>a table of the observed frequencies.</p></dd>


<dt>expected</dt>
<dd><p>a table of the estimated frequencies.</p></dd>


<dt>rho</dt>
<dd><p>percentage of estimated frequencies greater than one.</p></dd>


<dt>test</dt>
<dd><p>a character vector of the type of test statistic used.</p></dd>


<dt>tables</dt>
<dd><p>a TRUE or FALSE logical vector.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The Pulkstenis-Robinson test groups the observations using the covariate
patterns obtained from the categorical covariates. Each covariate pattern
is subsequently split in two based on the median ordinal scores. The test
statistic (chi-sq or deviance) is obtaned using the tabulated observed and
estimated frequencies. Assuming c is the number of covariate patterns, r the
number of response categories and k the number of categorical variables in
the model, the test statistic approximates the chi-sq distribution with
(2c - 1)(r - 1) - k - 1 degrees of freedom (Pulkstenis and Robinson (2004)).
As recommended in Fagerland and Hosmer (2016, 2017), this test should
be compared with the Hosmer-Lemeshow and the Lipsitz tests.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Pulkstenis, E. and Robinson, T. J. (2004). Goodness-of-fit tests for ordinal
    response regression models. <em>Statistics in Medicine</em> 23, 999-1014.</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2016). Tests for goodness of fit in
    ordinal logistic regression models. <em>Journal of Statistical
    Computation and Simulation</em>, 86, 3398-3418.</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2017). How to test for goodness of fit
    in ordinal logistic regression models. <em>Stata Journal</em>, 17, 668-686.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="hosmerlem.html">hosmerlem</a></code>, <code><a href="lipsitz.html">lipsitz</a></code>, <code><a href="brant.test.html">brant.test</a></code>,
<code><a href="LR.test.html">LR.test</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.auckland.ac.nz/~yee/VGAM/" class="external-link">VGAM</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">2</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## proportional odds model</span></span></span>
<span class="r-in"><span><span class="va">vg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vglm.html" class="external-link">vglm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, model <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>           family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/cumulative.html" class="external-link">cumulative</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logitlink"</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pulkroben</span><span class="op">(</span><span class="va">vg</span>, tables <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Pulkstenis-Robinson Chi-squared Test:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     chi-sq   df   pr(&gt;chi)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ordinal(pulkroben)  10.021    4    0.04007 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H0: No lack of fit dictated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho: 100% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Observed Freqs:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cov.pat total  0  1  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p1    75 21 37 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       q1    74 14 38 22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p2    26  1 18  7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       q2    25  5 17  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Expected Freqs:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cov.pat      0      1      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p1 16.791 41.414 16.795</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       q1 14.625 40.688 18.687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p2  5.284 14.318  6.399</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       q2  4.401 13.594  7.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  p &lt;= median OS; q &gt; median OS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## adjacent category model</span></span></span>
<span class="r-in"><span><span class="va">ac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">vg</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/acat.html" class="external-link">acat</a></span><span class="op">(</span>parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pulkroben</span><span class="op">(</span><span class="va">ac</span>, tables <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Pulkstenis-Robinson Chi-squared Test:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     chi-sq   df   pr(&gt;chi)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ordinal(pulkroben)  9.9975    4    0.04047 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H0: No lack of fit dictated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho: 100% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Observed Freqs:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cov.pat total  0  1  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p1    75 21 37 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       q1    74 14 38 22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p2    26  1 18  7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       q2    25  5 17  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Expected Freqs:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cov.pat      0      1      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p1 16.804 41.381 16.815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       q1 14.655 40.699 18.645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p2  5.209 14.306  6.485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       q2  4.331 13.614  7.055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  p &lt;= median OS; q &gt; median OS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## continuation ratio model</span></span></span>
<span class="r-in"><span><span class="va">cr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">vg</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/cratio.html" class="external-link">cratio</a></span><span class="op">(</span>parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pulkroben</span><span class="op">(</span><span class="va">cr</span>, tables <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Pulkstenis-Robinson Chi-squared Test:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     chi-sq   df   pr(&gt;chi)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ordinal(pulkroben)  10.145    4    0.03806 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H0: No lack of fit dictated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho: 100% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Observed Freqs:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cov.pat total  0  1  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p1    75 21 37 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       q1    74 14 38 22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p2    26  1 18  7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       q2    25  5 17  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Expected Freqs:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cov.pat      0      1      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p1 16.390 41.612 16.998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       q1 14.480 40.506 19.014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p2  5.481 14.372  6.148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       q2  4.650 13.571  6.779</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  p &lt;= median OS; q &gt; median OS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ejike R. Ugba.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

