<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Lipsitz Test for Categorical Response Models — lipsitz • gofcat</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Lipsitz Test for Categorical Response Models — lipsitz"><meta property="og:description" content="This provides a post estimation goodness-of-fit test for
the ordinal response models. Supported models include the proportional odds,
adjacent-category, and constrained continuation-ratio models."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gofcat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ejikeugba/gofcat/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Lipsitz Test for Categorical Response Models</h1>
    <small class="dont-index">Source: <a href="https://github.com/ejikeugba/gofcat/blob/HEAD/R/lipsitz.R" class="external-link"><code>R/lipsitz.R</code></a></small>
    <div class="hidden name"><code>lipsitz.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This provides a post estimation goodness-of-fit test for
the ordinal response models. Supported models include the proportional odds,
adjacent-category, and constrained continuation-ratio models.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lipsitz</span><span class="op">(</span><span class="va">model</span>, group <span class="op">=</span> <span class="fl">10</span>, customFreq <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>model</dt>
<dd><p>a model object or data.frame of observed and estimated
values. The following class of objects can be directly passed to the
<code>lipsitz</code> function: vglm(), serp(), polr(), and clm(). Other class of
objects require providing a data.frame of observed and predicted values.</p></dd>


<dt>group</dt>
<dd><p>Default to 10. The number of groups to be formed from the
original observations.</p></dd>


<dt>customFreq</dt>
<dd><p>a vector of custom group frequencies to be used instead of
the default equal group frequencies. The vector should, however, sum up to
the total number of original observations.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>LR</dt>
<dd><p>the realized value of the likelihood ratio statistic.</p></dd>


<dt>df</dt>
<dd><p>the degrees of freedom.</p></dd>


<dt>p.value</dt>
<dd><p>the p-value of the test.</p></dd>


<dt>newVar</dt>
<dd><p>a numeric vector of the newly generated variable.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Similar to the ordinal Hosmer-Lemeshow test (<code><a href="hosmerlem.html">hosmerlem</a></code>),
the Lipsitz test also group the observations into k separate groups using
the ordinal scores of the estimated values. According to Lipsitz, Fitzmaurice,
and Molenberghs (1996), the number of groups should be such that 6 &lt;= k &lt; n/5r,
with r the number of response category. An indicator variable is used to
denote the observations belonging to each group, producing additional pseudo
variables with which the original model is updated. Supposing the original
model fits correctly, then the coefficients of the pseudo variables all equal
zero. The likelihood ratio statistic calculated from the log likelihoods of
the original and the refitted models is subsequently compared with the
chi-squared distribution with k - 1 degrees of freedom.</p>
<p>The Lipsitz test compliments the ordinal Hosmer-Lemeshow and the
Pulkstenis-Robinson tests. Fagerland and Hosmer (2013, 2016, 2017)
recommend comparing the three test.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Fagerland, M. W. and Hosmer, D. W. (2013). A goodness-of-fit test for the
    proportional odds regression model. <em>Statistics in Medicine</em>,
    32, 2235-2249.</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2016). Tests for goodness of fit in
    ordinal logistic regression models. <em>Journal of Statistical
    Computation and Simulation</em>, 86, 3398-3418.</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2017). How to test for goodness of fit
    in ordinal logistic regression models. <em>Stata Journal</em>, 17, 668-686.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="hosmerlem.html">hosmerlem</a></code>, <code><a href="pulkroben.html">pulkroben</a></code>, <code><a href="brant.test.html">brant.test</a></code>,
<code><a href="LR.test.html">LR.test</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.auckland.ac.nz/~yee/VGAM/" class="external-link">VGAM</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">2</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## proportional odds model</span></span></span>
<span class="r-in"><span><span class="va">vg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vglm.html" class="external-link">vglm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, model <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>           family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/cumulative.html" class="external-link">cumulative</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logitlink"</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">lipsitz</span><span class="op">(</span><span class="va">vg</span>, group<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Lipsitz Test:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       LR   df   pr(&gt;chi)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ordinal(lipsitz)  8.6367    5     0.1245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H0: No lack of fit dictated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## adjacent category model</span></span></span>
<span class="r-in"><span><span class="va">ac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">vg</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/acat.html" class="external-link">acat</a></span><span class="op">(</span>parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">lipsitz</span><span class="op">(</span><span class="va">ac</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Lipsitz Test:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       LR   df   pr(&gt;chi)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ordinal(lipsitz)  12.662    9     0.1785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H0: No lack of fit dictated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## continuation ratio model</span></span></span>
<span class="r-in"><span><span class="va">cr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">vg</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/cratio.html" class="external-link">cratio</a></span><span class="op">(</span>parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">lipsitz</span><span class="op">(</span><span class="va">cr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Lipsitz Test:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       LR   df   pr(&gt;chi)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ordinal(lipsitz)  13.047    9     0.1605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H0: No lack of fit dictated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ejike R. Ugba.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

